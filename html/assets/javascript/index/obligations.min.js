(function(n){"use strict";const a=({methodName:a,data:t})=>new Promise((e,i)=>{n.PostComponents(a,t,n=>{e(n)})});class t{constructor(){}async renderGlobal(){var t=await a({methodName:"ALL_DATA",data:n.allData.User._id}),e=$(`\n                <div class="settingBlock" style="margin-bottom: 20px">\n                    <div class="version2_default_bkg row_default"></div>\n                    <div class="settingBlock_header">\n                        <div class="invester_status_projects_status_first">\n                            <div class="invester_status_projects_status_first_line">\n                                <span>Привлечено</span>\n                                <a>${t.obligations_data.attracted.toString().ReplaceNumber()} руб</a>\n                                <span>Коммисия investiR</span>\n                                <a>${t.obligations_data.commission.toString().ReplaceNumber()} руб</a>\n                            </div>\n                            <div class="invester_status_projects_status_first_line">\n                                <span>Выплачено</span>\n                                <a>${t.obligations_data.commissionPay.toString().ReplaceNumber()} руб</a>\n                                <span>Задолженость</span>\n                                <a>${t.obligations_data.DebtComission.toString().ReplaceNumber()} руб</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `);$(".index_page_body_data").append(e);e=$('\n                <div class="obligations_block">\n\n                </div>\n            ');t.obligations_data.showBlocks.forEach(n=>{var a=n.repayData,t=!1;a?a=DateFormatted(Number(n.repayData)+864e6):(t=!0,a="Отсутствует");var i=$(`\n                    <div class="obligations_block_element" data="${n.project._id}">\n                        <div class="version2_default_bkg row_default"></div>\n                        <div class="obligations_block_element_row">\n                            <div class="obligations_block_element_header">\n                                <h1>Проект ${n.project._id}</h1>\n                                <h2>${n.project.data.name}</h2>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Привлечено</span>\n                                <p>${n.attracted.toString().ReplaceNumber()} руб</p>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Коммисия investiR</span>\n                                <p>${n.project.payersData.commission} %</p>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Коммисия investiR</span>\n                                <p>${n.accrued.toString().ReplaceNumber()} руб</p>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Выплачено</span>\n                                <p>${n.commissionPay.toString().ReplaceNumber()} руб</p>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Задолженость</span>\n                                <p>${n.DebtComission.toString().ReplaceNumber()} руб</p>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Погаисть до</span>\n                                <p class="alert_p_alert">${a}</p>\n                            </div>\n                            <div class="obligations_block_element_line">\n                                <span>Договор реквезиты</span>\n                                <p>Открыть</p>\n                            </div>\n                            <div class="obligations_block_element_button">\n                                <span>Написать investiR</span>\n                            </div>\n                        </div>\n                    </div>\n                `);t||Number(Number(n.repayData)+864e6)<Number((new Date).getTime().toString())&&(i.attr("alertForLine","true"),i.find("h3").html("Имеется задолженость")),i.click(function(){location.href="./?page=obligations&ProjectId="+$(this).attr("data")}),e.append(i)}),$(".index_page_body_data").append(e),setInterval(function(){$('.obligations_block_element[alertForLine="true"]').toggleClass("alertForLine")},1e3)}async renderType(){var n=await a({methodName:"obligationsProjectData",data:_GET("ProjectId")}),t=$(`\n                <div class="settingBlock">\n                    <div class="version2_settingBlock_header">\n                        <p>Проект № ${n.project._id} ${n.project.data.name}</p>\n                    </div>\n                    <div class="version2_default_bkg row_default"></div>\n                    <div class="settingBlock_header">\n                        <div class="settingBlock_header_line">\n                            <span>№</span>\n                            <span>Привлечено</span>\n                            <span>№ Договора от</span>\n                            <span>Комиссия</span>\n                            <span>Оплатить до</span>\n                            <span>Чек об оплате</span>\n                            <span>Статус</span>\n                        </div>\n                    </div>\n                    <div class="settingBlock_body">\n\n                    </div>\n                </div>\n            `);n.Invs.forEach(function(e,i){var s=$(`\n                    <div class="settingBlock_body_line settingBlock_body_line_obligations" data="${e._id}" dataInv="${e.Inv._id}">\n                        <span>${i+1}</span>\n                        <span>${e.Inv.data.pay} руб</span>\n                        <span>${n.project._id}/${e.initNuberProject} от ${DateFormatted(e.Inv.date)}</span>\n                        <span>${Number(e.Inv.data.pay.toString().replace(/\s/g,"")/100*n.project.payersData.commission).toString().ReplaceNumber()} руб</span>\n                        <span>${DateFormatted(Number(e.Inv.date)+864e6)}</span>\n                        <span class="settingBlock_body_line_obligations_put">\n                            <label for="${e.Inv._id}">Прикрепить</label>\n                        </span>\n                        <span>Не оплачено</span>\n                        <input type="file" name="" id="${e.Inv._id}" data-project="${n.project._id}">\n                    </div>\n                `);if(e.commission){if("accept"==e.commission.status){var o=$(`<a href="https://investir.one/projects/${n.project._id}/${e.commission.recipient}" target="_blank">Посмотреть</a>`);s.find(".settingBlock_body_line_obligations_put").empty().append(o),s.children("span").eq(6).html("Подтверждено")}if("wait"==e.commission.status){o=$(`<a href="https://investir.one/projects/${n.project._id}/${e.commission.recipient}" target="_blank">Посмотреть</a>`);s.find(".settingBlock_body_line_obligations_put").empty().append(o),s.children("span").eq(6).html("Ожидает подтверждения от investiR")}if("wait_accept"==e.commission.status){s.find(".settingBlock_body_line_obligations_put").css("display","block"),s.children("span").eq(6).html("Ожидает подтверждения");o=$(`\n                            <label class="settingBlock_body_line_obligations_btn" for="${e.Inv._id}">Заменить</label>\n                            <div class="settingBlock_body_line_obligations_btn">\n                                <span>Посмотерть</span>\n                            </div>\n                            <div class="settingBlock_body_line_obligations_btn">\n                                <span>Подтвердить</span>\n                            </div>\n                        `);o.eq(2).click(function(){window.open(`https://investir.one/projects/${n.project._id}/${e.commission.recipient}`,"_blank")}),o.eq(4).click(async function(){await a({methodName:"obligations_accept_commission_put",data:$(this).parent().parent().attr("dataInv")}),alert("Успешно!"),location.reload()}),s.find(".settingBlock_body_line_obligations_put").empty().append(o)}}else Number(Number(e.Inv.date)+864e6)<Number((new Date).getTime().toString())&&s.attr("alertForLine","true");t.find(".settingBlock_body").append(s)}),t.find('input[type="file"]').change(async function(){var n=new FormData;n.append("invId",$(this).attr("id")),n.append("_id",$(this).attr("data-project")),n.append("_pts",$(this.files)[0].type),n.append("files",$(this.files)[0]);var a=`${getURL()}/file_commission.io/files`;axios.post(a,n,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{"ok"==n.data.status&&(alert("Чек прикоеплен!"),location.reload())})}),$(".index_page_body_data").append(t),setInterval(function(){$('.settingBlock_body_line[alertForLine="true"]').toggleClass("alertForLine")},1e3)}async render(){_GET("ProjectId")?this.renderType():this.renderGlobal()}}var e={obligations:t};if(n.Components)for(var i in e)n.Components[i]=e[i];else n.Components=e})(window);